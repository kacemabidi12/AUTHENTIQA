{"ast":null,"code":"const API_BASE = process.env.REACT_APP_API_BASE_URL || 'http://localhost:5001';\nconsole.log('REACT_APP_API_BASE_URL =', process.env.REACT_APP_API_BASE_URL);\nlet logoutHandler = null;\nexport function setLogoutHandler(fn) {\n  logoutHandler = fn;\n}\nfunction buildUrl(path) {\n  if (!path) return API_BASE || path;\n  // if path already absolute, return as is\n  if (path.startsWith('http://') || path.startsWith('https://')) return path;\n  return `${API_BASE}${path}`;\n}\nasync function request(method, path, {\n  body,\n  headers: extraHeaders,\n  params\n} = {}) {\n  const url = new URL(buildUrl(path), window.location.origin);\n  if (params && typeof params === 'object') {\n    Object.keys(params).forEach(k => {\n      if (params[k] != null) url.searchParams.append(k, params[k]);\n    });\n  }\n  const token = localStorage.getItem('auth_token');\n  const headers = {\n    'Content-Type': 'application/json',\n    ...(extraHeaders || {})\n  };\n  if (token) headers['Authorization'] = `Bearer ${token}`;\n  const res = await fetch(url.toString(), {\n    method,\n    headers,\n    body: body != null ? JSON.stringify(body) : undefined\n  });\n  if (res.status === 401) {\n    // auto logout\n    if (typeof logoutHandler === 'function') logoutHandler();\n    const err = new Error('Unauthorized');\n    err.status = 401;\n    throw err;\n  }\n  const text = await res.text();\n  let data = null;\n  try {\n    data = text ? JSON.parse(text) : null;\n  } catch (e) {\n    data = text;\n  }\n  if (!res.ok) {\n    const message = data && data.message || res.statusText || 'Request failed';\n    const err = new Error(message);\n    err.status = res.status;\n    err.data = data;\n    throw err;\n  }\n  return data;\n}\nexport const api = {\n  get: (path, opts) => request('GET', path, opts),\n  post: (path, body, opts) => request('POST', path, {\n    ...opts,\n    body\n  }),\n  put: (path, body, opts) => request('PUT', path, {\n    ...opts,\n    body\n  }),\n  del: (path, opts) => request('DELETE', path, opts)\n};\nexport default api;","map":{"version":3,"names":["API_BASE","process","env","REACT_APP_API_BASE_URL","console","log","logoutHandler","setLogoutHandler","fn","buildUrl","path","startsWith","request","method","body","headers","extraHeaders","params","url","URL","window","location","origin","Object","keys","forEach","k","searchParams","append","token","localStorage","getItem","res","fetch","toString","JSON","stringify","undefined","status","err","Error","text","data","parse","e","ok","message","statusText","api","get","opts","post","put","del"],"sources":["/Users/admin/Downloads/AUTHENTIQA/client/src/api.js"],"sourcesContent":["const API_BASE = process.env.REACT_APP_API_BASE_URL || 'http://localhost:5001';\nconsole.log('REACT_APP_API_BASE_URL =', process.env.REACT_APP_API_BASE_URL);\n\nlet logoutHandler = null;\nexport function setLogoutHandler(fn) {\n  logoutHandler = fn;\n}\n\nfunction buildUrl(path) {\n  if (!path) return API_BASE || path;\n  // if path already absolute, return as is\n  if (path.startsWith('http://') || path.startsWith('https://')) return path;\n  return `${API_BASE}${path}`;\n}\n\nasync function request(method, path, { body, headers: extraHeaders, params } = {}) {\n  const url = new URL(buildUrl(path), window.location.origin);\n  if (params && typeof params === 'object') {\n    Object.keys(params).forEach(k => {\n      if (params[k] != null) url.searchParams.append(k, params[k]);\n    });\n  }\n\n  const token = localStorage.getItem('auth_token');\n  const headers = { 'Content-Type': 'application/json', ...(extraHeaders || {}) };\n  if (token) headers['Authorization'] = `Bearer ${token}`;\n\n  const res = await fetch(url.toString(), {\n    method,\n    headers,\n    body: body != null ? JSON.stringify(body) : undefined\n  });\n\n  if (res.status === 401) {\n    // auto logout\n    if (typeof logoutHandler === 'function') logoutHandler();\n    const err = new Error('Unauthorized');\n    err.status = 401;\n    throw err;\n  }\n\n  const text = await res.text();\n  let data = null;\n  try { data = text ? JSON.parse(text) : null; } catch (e) { data = text; }\n\n  if (!res.ok) {\n    const message = (data && data.message) || res.statusText || 'Request failed';\n    const err = new Error(message);\n    err.status = res.status;\n    err.data = data;\n    throw err;\n  }\n\n  return data;\n}\n\nexport const api = {\n  get: (path, opts) => request('GET', path, opts),\n  post: (path, body, opts) => request('POST', path, { ...opts, body }),\n  put: (path, body, opts) => request('PUT', path, { ...opts, body }),\n  del: (path, opts) => request('DELETE', path, opts)\n};\n\nexport default api;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}